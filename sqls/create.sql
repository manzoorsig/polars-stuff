CREATE DATABASE IF NOT EXISTS POLARIS_DW;
SET GLOBAL default_table_type = 'columnstore';
USE POLARIS_DW;
CREATE TABLE IF NOT EXISTS CUSTOMER_DIMENSION (
    ID BIGINT PRIMARY KEY AUTO_INCREMENT,
    ORGANIZATION_ID VARCHAR(36) NOT NULL,
    CUSTOMER_NAME VARCHAR(128) NOT NULL,
    TENANT_SHORT_ID VARCHAR(4) NOT NULL,
    STATE VARCHAR(30) NOT NULL,
    IS_DELETED TINYINT DEFAULT 0 ,
    CREATED_AT DATETIME(6) NOT NULL,
    UPDATED_AT DATETIME(6) NOT NULL,
    CREATE_DATETIME DATETIME(6) NOT NULL,
    UPDATE_DATETIME DATETIME(6) NOT NULL,
    SORT KEY (IS_DELETED,ORGANIZATION_ID, CUSTOMER_NAME, STATE),
    SHARD KEY(ID)
); 

CREATE TABLE IF NOT EXISTS APPLICATION_WITH_BRANCHES_DIMENSION (
    ID BIGINT PRIMARY KEY AUTO_INCREMENT,
    ORGANIZATION_ID VARCHAR(36) NOT NULL,
    APPLICATION_ID VARCHAR(36) NOT NULL,
    APPLICATION_NAME VARCHAR(256) NOT NULL,
    APPLICATION_DESCRIPTION VARCHAR(2048),
    IS_APPLICATION_DELETED TINYINT DEFAULT 0 ,
    APPLICATION_CREATED_AT DATETIME(6) NOT NULL,
    APPLICATION_UPDATED_AT DATETIME(6) NOT NULL,
    PROJECT_ID VARCHAR(36) NOT NULL,
    PROJECT_NAME VARCHAR(256) NOT NULL,
    PROJECT_DESCRIPTION VARCHAR(2048),
    IS_PROJECT_DELETED TINYINT DEFAULT 0 ,
    PROJECT_CREATED_AT DATETIME(6) NOT NULL,
    PROJECT_UPDATED_AT DATETIME(6) NOT NULL,
    PROJECT_STATE VARCHAR(255) NOT NULL,
    PROJECT_ENTRY_POINT_URL VARCHAR(255),
    BRANCH_ID VARCHAR(36) NOT NULL,
    BRANCH_NAME VARCHAR(256) NOT NULL,
    BRANCH_DESCRIPTION VARCHAR(256),
    BRANCH_IS_DEFAULT TINYINT DEFAULT 0 ,
    IS_BRANCH_DELETED TINYINT DEFAULT 0 ,
    BRANCH_CREATED_AT DATETIME(6) NOT NULL,
    BRANCH_UPDATED_AT DATETIME(6) NOT NULL,
    CREATE_DATETIME DATETIME(6) NOT NULL,
    UPDATE_DATETIME DATETIME(6) NOT NULL,
    SORT KEY (IS_APPLICATION_DELETED,ORGANIZATION_ID, APPLICATION_ID,PROJECT_STATE,PROJECT_ID),
    SHARD KEY(ID)
); 


CREATE TABLE IF NOT EXISTS APPLICATION_DIMENSION (
    ID BIGINT PRIMARY KEY AUTO_INCREMENT,
    ORGANIZATION_ID VARCHAR(36) NOT NULL,
    APPLICATION_ID VARCHAR(36) NOT NULL,
    APPLICATION_NAME VARCHAR(256) NOT NULL,
    APPLICATION_DESCRIPTION VARCHAR(2048),
    IS_APPLICATION_DELETED TINYINT DEFAULT 0 ,
    APPLICATION_CREATED_AT DATETIME(6) NOT NULL,
    APPLICATION_UPDATED_AT DATETIME(6) NOT NULL,
    PROJECT_ID VARCHAR(36) NOT NULL,
    PROJECT_NAME VARCHAR(256) NOT NULL,
    PROJECT_DESCRIPTION VARCHAR(2048),
    IS_PROJECT_DELETED TINYINT DEFAULT 0 ,
    PROJECT_CREATED_AT DATETIME(6) NOT NULL,
    PROJECT_UPDATED_AT DATETIME(6) NOT NULL,
    PROJECT_STATE VARCHAR(255) NOT NULL,
    PROJECT_ENTRY_POINT_URL VARCHAR(255),
    CREATE_DATETIME DATETIME(6) NOT NULL,
    UPDATE_DATETIME DATETIME(6) NOT NULL,
    SORT KEY (IS_APPLICATION_DELETED,ORGANIZATION_ID, APPLICATION_ID,PROJECT_STATE,PROJECT_ID, BRANCH_ID),
    SHARD KEY(ID)
); 